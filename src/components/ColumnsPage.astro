---
import siteData from '../../siteData.mjs';
import Columns from '../components/Columns.astro';
import { getCollection } from 'astro:content';
import Button from '../components/Button';

const columns = await getCollection('columns');
const sorted = columns.sort(
    (a: ColumnsEntry, b: ColumnsEntry) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime()
);

type ColumnsEntry = {
    data: { date: string; title: string; category?: string; image: string };
    slug: string;
};

const columnsItems = sorted.map((item: ColumnsEntry) => ({
    date: item.data.date,
    category: item.data.category,
    title: item.data.title,
    image: item.data.image ?? '',
    slug: item.slug
}));

interface Props {
    wrapperClass?: string;
}

const { wrapperClass = '' } = Astro.props;
---

<section class={`${wrapperClass} columns-page l-wrapper py-8 mt-20 sm:py-4 sm:mt-4`}>
    <div class="l-container sm:px-4">
        <div class="l-inner">
            <h2 class="font-bold text-center en pt-10">columns</h2>
            <div class="columns-page__card px-6 py-6 mb-8 sm:px-0">
                <div class="flex flex-col justify-center sm:justify-start">
                    <Columns columnsItems={columnsItems} />
                </div>
                <div class="flex justify-center">
                    <Button href={siteData.works.path} className="works__btn" variant="push">
                        <span>制作物：works はこちら</span>
                    </Button>
                </div>
            </div>
        </div>
    </div>
</section>
